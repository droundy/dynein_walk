#include <stdio.h>
#include <stdlib.h>
#include <fstream>
#include <math.h>

const double Lt = 10;
const double Ls = 10;

const double kt = 1;
const double kml = 1;
const double kmr = 1;
const double kbl = 1;
const double kbr = 1;

const double mb = 1;
const double mm = 1;
const double mt = 1;

const double bA = M_PI/4;
const double mA = M_PI/4;
const double tA = M_PI/4;

FILE* file;

typedef enum {
	LEFTBOUND,
	RIGHTBOUND,
	BOTHBOUND
} states;

double randAngle(double range);
double dist(double d, double h, double i, double j);

class Dynein {
	public:
	
		void set_bla(double d);
		void set_mla(double d);
		void set_mra(double d);
		void set_bra(double d);
		
		void set_blx(double d);
		void set_bly(double d);
		
		void set_d_bla(double d);
		void set_d_mla(double d);
		void set_d_mra(double d);
		void set_d_bra(double d);
		
		double get_bly();
		double get_blx();
		
		double get_bla();
		double get_mla();
		double get_mra();
		double get_bra();
		
		double get_d_bla();
		double get_d_mla();
		double get_d_mra();
		double get_d_bra();
		
		double get_dd_bla();
		double get_dd_mla();
		double get_dd_mra();
		double get_dd_bra();
		
		double get_PE();
		
		void log(double t);
		
	private:
		double bla;
		double mla;
		double mra;
		double bra;
	
		double d_bla; //Angular Velocities
		double d_mla;
		double d_mra;
		double d_bra;
		
		double blx;
		double bly;
		
		int state;
		
		double square(double num);
		double cube(double num);
};

/*** Accessor Methods ***/

void Dynein::set_blx(double d) {
	blx = d;
}

void Dynein::set_bly(double d) {
	bly = d;
}

void Dynein::set_bla(double d) {
	bla = d;
}

void Dynein::set_mla(double d) {
	mla = d;
}

void Dynein::set_mra(double d) {
	mra = d;
}

void Dynein::set_bra(double d) {
	bra = d;
}

void Dynein::set_d_bla(double d) {
	d_bla = d;
}

void Dynein::set_d_mla(double d) {
	d_mla = d;
}

void Dynein::set_d_mra(double d) {
	d_mra = d;
}

void Dynein::set_d_bra(double d) {
	d_bra = d;
}

double Dynein::get_d_bla() {
	return d_bla;
}

double Dynein::get_d_mla() {
	return d_mla;
}

double Dynein::get_d_mra() {
	return d_mra;
}

double Dynein::get_d_bra() {
	return d_bra;
}

double Dynein::get_bly() {
	return bly;
}
double Dynein::get_blx(){
	return blx;
}

double Dynein::get_dd_bla() { 
	return  -(4 * square(Ls) * Lt * mt * sin(2 * (get_bla() - get_mla())) * square(get_d_bla()) * square(mm) +8 * Ls * square(Lt) * mt * sin(get_bla() - get_mla()) * square(get_d_mla()) * square(mm) -4 * Ls * square(Lt) * mt * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_mra()) * square(mm) -4 * Ls * square(Lt) * mt * sin(get_bla() + get_mra()) * square(get_d_mra()) * square(mm) - 4 * bA * kbl * Lt * square(mm) - 4 * kml * Lt * mA * square(mm) -4 * kml * Ls * mA * cos(get_bla() - get_mla()) * square(mm) -4 * kt * Ls * tA * cos(get_bla() - get_mla()) * square(mm) +4 * kmr * Ls * mA * cos(get_bla() - 2 * get_mla() - get_mra()) * square(mm) -4 * kt * Ls * tA * cos(get_bla() - 2 * get_mla() - get_mra()) * square(mm) -4 * kmr * Ls * mA * cos(get_bla() + get_mra()) * square(mm) +4 * kt * Ls * tA * cos(get_bla() + get_mra()) * square(mm) +4 * bA * kbl * Lt * cos(2 * (get_mla() + get_mra())) * square(mm) +4 * kml * Lt * mA * cos(2 * (get_mla() + get_mra())) * square(mm) +4 * kml * Ls * mA * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) +4 * kt * Ls * tA * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) +4 * kt * Ls * cos(get_bla() - get_mla()) * get_mra() * square(mm) +4 * kmr * Ls * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * square(mm) +4 * kt * Ls * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * square(mm) -4 * kmr * Ls * cos(get_bla() + get_mra()) * get_mra() * square(mm) -4 * kt * Ls * cos(get_bla() + get_mra()) * get_mra() * square(mm) -4 * kt * Ls * cos(get_bla() + get_mla() + 2 * get_mra()) * get_mra() * square(mm) -8 * kmr * Ls * get_bra() * sin(get_bla() - get_mla()) * sin(get_mla() + get_mra()) * square(mm) +4 * square(Ls) * Lt * square(mt) * sin(2 * (get_bla() - get_mla())) * square(get_d_bla()) * mm +4 * square(Ls) * Lt * mb * mt * sin(2 * (get_bla() - get_mla())) * square(get_d_bla()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() + get_bra()) * square(get_d_bra()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() - get_bra() - 2 * get_mla()) * square(get_d_bra()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() - get_bra() + 2 * get_mra()) * square(get_d_bra()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * square(get_d_bra()) * mm +8 * Ls * square(Lt) * square(mt) * sin(get_bla() - get_mla()) * square(get_d_mla()) * mm +8 * Ls * square(Lt) * mb * mt * sin(get_bla() - get_mla()) * square(get_d_mla()) * mm -4 * Ls * square(Lt) * mb * mt * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_mra()) * mm -4 * Ls * square(Lt) * mb * mt * sin(get_bla() + get_mra()) * square(get_d_mra()) * mm - 4 * bA * kbl * Lt * mb * mm - 4 * kml * Lt * mA * mb * mm -8 * bA * kbl * Lt * mt * mm - 8 * kml * Lt * mA * mt * mm +2 * kmr * Lt * mA * mt * cos(get_bla() + get_bra()) * mm -4 * kml * Ls * mA * mb * cos(get_bla() - get_mla()) * mm -8 * kml * Ls * mA * mt * cos(get_bla() - get_mla()) * mm -4 * kt * Ls * mb * tA * cos(get_bla() - get_mla()) * mm -8 * kt * Ls * mt * tA * cos(get_bla() - get_mla()) * mm -2 * kmr * Lt * mA * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * mm +4 * kmr * Ls * mA * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * mm +4 * kmr * Ls * mA * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * kt * Ls * mb * tA * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * kt * Ls * mt * tA * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * kmr * Ls * mA * mb * cos(get_bla() + get_mra()) * mm -4 * kmr * Ls * mA * mt * cos(get_bla() + get_mra()) * mm +4 * kt * Ls * mb * tA * cos(get_bla() + get_mra()) * mm +4 * kt * Ls * mt * tA * cos(get_bla() + get_mra()) * mm +4 * bA * kbl * Lt * mb * cos(2 * (get_mla() + get_mra())) * mm +4 * kml * Lt * mA * mb * cos(2 * (get_mla() + get_mra())) * mm -2 * kmr * Lt * mA * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * mm +4 * kml * Ls * mA * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm +4 * kt * Ls * mb * tA * cos(get_bla() + get_mla() + 2 * get_mra()) * mm +2 * kmr * Lt * mA * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * mm +2 * kmr * Lt * mt * cos(get_bla() + get_bra()) * get_mra() * mm +4 * kt * Ls * mb * cos(get_bla() - get_mla()) * get_mra() * mm +8 * kt * Ls * mt * cos(get_bla() - get_mla()) * get_mra() * mm -2 * kmr * Lt * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * get_mra() * mm +4 * kmr * Ls * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * mm +4 * kt * Ls * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * mm +4 * kmr * Ls * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * mm +4 * kt * Ls * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() * mm -4 * kmr * Ls * mb * cos(get_bla() + get_mra()) * get_mra() * mm -4 * kt * Ls * mb * cos(get_bla() + get_mra()) * get_mra() * mm -4 * kmr * Ls * mt * cos(get_bla() + get_mra()) * get_mra() * mm -4 * kt * Ls * mt * cos(get_bla() + get_mra()) * get_mra() * mm -2 * kmr * Lt * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * get_mra() * mm -4 * kt * Ls * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * get_mra() * mm +2 * kmr * Lt * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * get_mra() * mm + 4 * kmr * Lt * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_bra() + get_mla()) * mm -8 * kmr * Ls * mb * get_bra() * sin(get_bla() - get_mla()) * sin(get_mla() + get_mra()) * mm -8 * kmr * Ls * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_mla() + get_mra()) * mm +4 * kmr * Lt * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_bra() - get_mla() - 2 * get_mra()) * mm +2 * square(Ls) * Lt * mb * square(mt) * sin(2 * (get_bla() - get_mla())) * square(get_d_bla()) - square(Ls) * Lt * mb * square(mt) * sin(2 * (get_bla() + get_bra() - get_mla() - get_mra())) * square(get_d_bla()) - square(Ls) * Lt * mb * square(mt) * sin(2 * (get_bla() - get_bra() - get_mla() + get_mra())) * square(get_d_bla()) + 4 * Ls * square(Lt) * mb * square(mt) * sin(get_bla() - get_mla()) * square(get_d_mla()) -2 * Ls * square(Lt) * mb * square(mt) * sin(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) * square(get_d_mla()) - 2 * Ls * square(Lt) * mb * square(mt) * sin(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) * square(get_d_mla()) - 4 * bA * kbl * Lt * mb * mt - 4 * kml * Lt * mA * mb * mt +2 * kmr * Lt * mA * mb * mt * cos(get_bla() + get_bra()) -4 * kml * Ls * mA * mb * mt * cos(get_bla() - get_mla()) -4 * kt * Ls * mb * mt * tA * cos(get_bla() - get_mla()) -2 * kmr * Lt * mA * mb * mt * cos(get_bla() - get_bra() - 2 * get_mla()) +4 * bA * kbl * Lt * mb * mt * cos(2 * (get_bra() - get_mra())) +4 * kml * Lt * mA * mb * mt * cos(2 * (get_bra() - get_mra())) +2 * kmr * Ls * mA * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) -2 * kt * Ls * mb * mt * tA * cos(get_bla() + 2 * get_bra() - get_mra()) +2 * kmr * Ls * mA * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) -2 * kt * Ls * mb * mt * tA * cos(get_bla() - 2 * get_mla() - get_mra()) -2 * kmr * Ls * mA * mb * mt * cos(get_bla() + get_mra()) +2 * kt * Ls * mb * mt * tA * cos(get_bla() + get_mra()) -2 * kmr * Ls * mA * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) +2 * kt * Ls * mb * mt * tA * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) -2 * kmr * Lt * mA * mb * mt * cos(get_bla() - get_bra() + 2 * get_mra()) +2 * kml * Ls * mA * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +2 * kt * Ls * mb * mt * tA * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +get_bla() * (4 * kml * Ls * (mb * (mm + mt) + mm * (mm + 2 * mt)) * cos(get_bla() - get_mla()) -2 * (-2 * kbl * Lt * square(mm) - 2 * kml * Lt * square(mm) +2 * kbl * Lt * cos(2 * (get_mla() + get_mra())) * square(mm) +2 * kml * Lt * cos(2 * (get_mla() + get_mra())) * square(mm) +2 * kml * Ls * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) -2 * kbl * Lt * mb * mm - 2 * kml * Lt * mb * mm - 4 * kbl * Lt * mt * mm -4 * kml * Lt * mt * mm +2 * kbl * Lt * mb * cos(2 * (get_mla() + get_mra())) * mm +2 * kml * Lt * mb * cos(2 * (get_mla() + get_mra())) * mm +2 * kml * Ls * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm -2 * kbl * Lt * mb * mt - 2 * kml * Lt * mb * mt +2 * (kbl + kml) * Lt * mb * mt * cos(2 * (get_bra() - get_mra())) +kml * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +kml * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()))) +2 * kml * Ls * mA * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) +2 * kt * Ls * mb * mt * tA * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) +2 * kmr * Lt * mA * mb * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) +2 * (-2 * kml * Lt * square(mm) -2 * kt * Ls * cos(get_bla() - 2 * get_mla() - get_mra()) * square(mm) +2 * kt * Ls * cos(get_bla() + get_mra()) * square(mm) +2 * kml * Lt * cos(2 * (get_mla() + get_mra())) * square(mm) +2 * kml * Ls * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) +2 * kt * Ls * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) -2 * kml * Lt * mb * mm - 4 * kml * Lt * mt * mm -2 * kt * Ls * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -2 * kt * Ls * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * mm +2 * kt * Ls * mb * cos(get_bla() + get_mra()) * mm +2 * kt * Ls * mt * cos(get_bla() + get_mra()) * mm +2 * kml * Lt * mb * cos(2 * (get_mla() + get_mra())) * mm +2 * kml * Ls * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm +2 * kt * Ls * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm -2 * kml * Lt * mb * mt -2 * (kml + kt) * Ls * (mb * (mm + mt) + mm * (mm + 2 * mt)) * cos(get_bla() - get_mla()) +2 * kml * Lt * mb * mt * cos(2 * (get_bra() - get_mra())) -kt * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) -kt * Ls * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) +kt * Ls * mb * mt * cos(get_bla() + get_mra()) +kt * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) +kml * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +kt * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) + (kml +kt) * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra())) * get_mla() +2 * kmr * Lt * mb * mt * cos(get_bla() + get_bra()) * get_mra() +4 * kt * Ls * mb * mt * cos(get_bla() - get_mla()) * get_mra() -2 * kmr * Lt * mb * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * get_mra() +2 * kmr * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) * get_mra() +2 * kmr * Ls * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mra() -2 * kmr * Ls * mb * mt * cos(get_bla() + get_mra()) * get_mra() -2 * kt * Ls * mb * mt * cos(get_bla() + get_mra()) * get_mra() -2 * kmr * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) * get_mra() - 2 * kt * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) * get_mra() -2 * kmr * Lt * mb * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * get_mra() -2 * kt * Ls * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) * get_mra() - 2 * kt * Ls * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) * get_mra() +2 * kmr * Lt * mb * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * get_mra() + 4 * kmr * Lt * mb * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_bra() + get_mla()) +4 * kmr * Ls * mb * mt * get_bra() * sin(get_bla() - get_mla()) * sin(2 * get_bra() + get_mla() - get_mra()) -4 * kmr * Ls * mb * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_mla() + get_mra()) +4 * kmr * Lt * mb * mt * get_bra() * sin(get_bla() - get_mla()) * sin(get_bra() - get_mla() -2 * get_mra()))/square((Ls) * Lt * (-4 * cos(2 * (get_mla() + get_mra())) * cube(mm) +4 * cube(mm) + 4 * mb * square(mm) + 12 * mt * square(mm) -4 * mb * cos(2 * (get_mla() + get_mra())) * square(mm) + 4 * square(mt) * mm +8 * mb * mt * mm + 2 * mb * square(mt) -2 * mt * (2 * mm * (mm + mt) + mb * (2 * mm + mt)) * cos(2 * (get_bla() - get_mla())) -2 * mb * mt * (2 * mm + mt) * cos(2 * (get_bra() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() + get_bra() - get_mla() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() - get_bra() - get_mla() + get_mra()))));
}

double Dynein::get_dd_mla() {
	return -(-4 * square(Ls) * Lt * sin(get_bla() - get_mla()) * square(get_d_bla()) * cube(mm) +4 * square(Ls) * Lt * sin(get_bla() + get_mla() + 2 * get_mra()) * square(get_d_bla()) * cube(mm) +4 * Ls * square(Lt) * sin(2 * (get_mla() + get_mra())) * square(get_d_mla()) * cube(mm) -8 * Ls * square(Lt) * sin(get_mla() + get_mra()) * square(get_d_mra()) * cube(mm) -4 * square(Ls) * Lt * mb * sin(get_bla() - get_mla()) * square(get_d_bla()) * square(mm) -16 * square(Ls) * Lt * mt * sin(get_bla() - get_mla()) * square(get_d_bla()) * square(mm) +4 * square(Ls) * Lt * mb * sin(get_bla() + get_mla() + 2 * get_mra()) * square(get_d_bla()) * square(mm) -4 * square(Ls) * Lt * mb * sin(get_bra() + get_mla()) * square(get_d_bra()) * square(mm) +4 * square(Ls) * Lt * mb * sin(get_bra() - get_mla() - 2 * get_mra()) * square(get_d_bra()) * square(mm) -4 * Ls * square(Lt) * mt * sin(2 * (get_bla() - get_mla())) * square(get_d_mla()) * square(mm) +4 * Ls * square(Lt) * mb * sin(2 * (get_mla() + get_mra())) * square(get_d_mla()) * square(mm) +4 * Ls * square(Lt) * mt * sin(2 * get_bla() - get_mla() + get_mra()) * square(get_d_mra()) * square(mm) -8 * Ls * square(Lt) * mb * sin(get_mla() + get_mra()) * square(get_d_mra()) * square(mm) -4 * Ls * square(Lt) * mt * sin(get_mla() + get_mra()) * square(get_d_mra()) * square(mm) + 12 * kml * Ls * mA * square(mm) + 12 * kt * Ls * tA * square(mm) +4 * bA * kbl * Lt * cos(get_bla() - get_mla()) * square(mm) +4 * kml * Lt * mA * cos(get_bla() - get_mla()) * square(mm) +4 * kmr * Lt * mA * cos(get_bra() + get_mla()) * square(mm) -4 * kml * Ls * mA * cos(2 * (get_bla() + get_mra())) * square(mm) -4 * kt * Ls * tA * cos(2 * (get_bla() + get_mra())) * square(mm) +4 * kmr * Ls * mA * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) -4 * kt * Ls * tA * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) -12 * kmr * Ls * mA * cos(get_mla() + get_mra()) * square(mm) +12 * kt * Ls * tA * cos(get_mla() + get_mra()) * square(mm) -4 * bA * kbl * Lt * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) -4 * kml * Lt * mA * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) -4 * kmr * Lt * mA * cos(get_bra() - get_mla() - 2 * get_mra()) * square(mm) +12 * kml * Ls * get_mla() * square(mm) + 12 * kt * Ls * get_mla() * square(mm) +4 * kml * Lt * cos(get_bla() - get_mla()) * get_mla() * square(mm) -4 * kml * Ls * cos(2 * (get_bla() + get_mra())) * get_mla() * square(mm) -4 * kt * Ls * cos(2 * (get_bla() + get_mra())) * get_mla() * square(mm) -4 * kt * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * square(mm) +12 * kt * Ls * cos(get_mla() + get_mra()) * get_mla() * square(mm) -4 * kml * Lt * cos(get_bla() + get_mla() + 2 * get_mra()) * get_mla() * square(mm) -12 * kt * Ls * get_mra() * square(mm) +4 * kmr * Lt * cos(get_bra() + get_mla()) * get_mra() * square(mm) +4 * kt * Ls * cos(2 * (get_bla() + get_mra())) * get_mra() * square(mm) +4 * kmr * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * square(mm) +4 * kt * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * square(mm) -12 * kmr * Ls * cos(get_mla() + get_mra()) * get_mra() * square(mm) -12 * kt * Ls * cos(get_mla() + get_mra()) * get_mra() * square(mm) -4 * kmr * Lt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * square(mm) -8 * square(Ls) * Lt * square(mt) * sin(get_bla() - get_mla()) * square(get_d_bla()) * mm -12 * square(Ls) * Lt * mb * mt * sin(get_bla() - get_mla()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * mb * mt * sin(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * mb * mt * sin(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * mb * mt * sin(2 * get_bla() + get_bra() - get_mla()) * square(get_d_bra()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bra() + get_mla()) * square(get_d_bra()) * mm +2 * square(Ls) * Lt * mb * mt * sin(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * square(get_d_bra()) * mm +2 * square(Ls) * Lt * mb * mt * sin(get_bra() - get_mla() - 2 * get_mra()) * square(get_d_bra()) * mm -4 * Ls * square(Lt) * square(mt) * sin(2 * (get_bla() - get_mla())) * square(get_d_mla()) * mm -4 * Ls * square(Lt) * mb * mt * sin(2 * (get_bla() - get_mla())) * square(get_d_mla()) * mm +4 * Ls * square(Lt) * mb * mt * sin(2 * get_bla() - get_mla() + get_mra()) * square(get_d_mra()) * mm -4 * Ls * square(Lt) * mb * mt * sin(get_mla() + get_mra()) * square(get_d_mra()) * mm + 8 * kml * Ls * mA * mb * mm + 8 * kml * Ls * mA * mt * mm +8 * kt * Ls * mb * tA * mm + 8 * kt * Ls * mt * tA * mm +4 * bA * kbl * Lt * mb * cos(get_bla() - get_mla()) * mm +4 * kml * Lt * mA * mb * cos(get_bla() - get_mla()) * mm +8 * bA * kbl * Lt * mt * cos(get_bla() - get_mla()) * mm +8 * kml * Lt * mA * mt * cos(get_bla() - get_mla()) * mm -2 * kmr * Lt * mA * mt * cos(2 * get_bla() + get_bra() - get_mla()) * mm +4 * kmr * Lt * mA * mb * cos(get_bra() + get_mla()) * mm +2 * kmr * Lt * mA * mt * cos(get_bra() + get_mla()) * mm -4 * kml * Ls * mA * mb * cos(2 * (get_bra() - get_mra())) * mm -4 * kt * Ls * mb * tA * cos(2 * (get_bra() - get_mra())) * mm +4 * kmr * Ls * mA * mb * cos(2 * get_bra() + get_mla() - get_mra()) * mm -4 * kt * Ls * mb * tA * cos(2 * get_bra() + get_mla() - get_mra()) * mm -4 * kml * Ls * mA * mb * cos(2 * (get_bla() + get_mra())) * mm -4 * kt * Ls * mb * tA * cos(2 * (get_bla() + get_mra())) * mm +4 * kmr * Ls * mA * mb * cos(2 * get_bla() - get_mla() + get_mra()) * mm +4 * kmr * Ls * mA * mt * cos(2 * get_bla() - get_mla() + get_mra()) * mm -4 * kt * Ls * mb * tA * cos(2 * get_bla() - get_mla() + get_mra()) * mm -4 * kt * Ls * mt * tA * cos(2 * get_bla() - get_mla() + get_mra()) * mm -8 * kmr * Ls * mA * mb * cos(get_mla() + get_mra()) * mm -4 * kmr * Ls * mA * mt * cos(get_mla() + get_mra()) * mm +8 * kt * Ls * mb * tA * cos(get_mla() + get_mra()) * mm +4 * kt * Ls * mt * tA * cos(get_mla() + get_mra()) * mm +2 * kmr * Lt * mA * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * mm -4 * bA * kbl * Lt * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm -4 * kml * Lt * mA * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm -4 * kmr * Lt * mA * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * mm -2 * kmr * Lt * mA * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * mm +8 * kml * Ls * mb * get_mla() * mm + 8 * kt * Ls * mb * get_mla() * mm +8 * kml * Ls * mt * get_mla() * mm + 8 * kt * Ls * mt * get_mla() * mm +4 * kml * Lt * mb * cos(get_bla() - get_mla()) * get_mla() * mm +8 * kml * Lt * mt * cos(get_bla() - get_mla()) * get_mla() * mm -4 * kml * Ls * mb * cos(2 * (get_bra() - get_mra())) * get_mla() * mm -4 * kt * Ls * mb * cos(2 * (get_bra() - get_mra())) * get_mla() * mm -4 * kt * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() * mm -4 * kml * Ls * mb * cos(2 * (get_bla() + get_mra())) * get_mla() * mm -4 * kt * Ls * mb * cos(2 * (get_bla() + get_mra())) * get_mla() * mm -4 * kt * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm -4 * kt * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm +8 * kt * Ls * mb * cos(get_mla() + get_mra()) * get_mla() * mm +4 * kt * Ls * mt * cos(get_mla() + get_mra()) * get_mla() * mm -4 * kml * Lt * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * get_mla() * mm -8 * kt * Ls * mb * get_mra() * mm - 8 * kt * Ls * mt * get_mra() * mm -2 * kmr * Lt * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mra() * mm +4 * kmr * Lt * mb * cos(get_bra() + get_mla()) * get_mra() * mm +2 * kmr * Lt * mt * cos(get_bra() + get_mla()) * get_mra() * mm +4 * kt * Ls * mb * cos(2 * (get_bra() - get_mra())) * get_mra() * mm +4 * kmr * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() * mm +4 * kt * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() * mm +4 * kt * Ls * mb * cos(2 * (get_bla() + get_mra())) * get_mra() * mm +4 * kmr * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm +4 * kt * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm +4 * kmr * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm +4 * kt * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm -8 * kmr * Ls * mb * cos(get_mla() + get_mra()) * get_mra() * mm -8 * kt * Ls * mb * cos(get_mla() + get_mra()) * get_mra() * mm -4 * kmr * Ls * mt * cos(get_mla() + get_mra()) * get_mra() * mm -4 * kt * Ls * mt * cos(get_mla() + get_mra()) * get_mra() * mm +2 * kmr * Lt * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mra() * mm - 4 * kmr * Lt * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * mm - 2 * kmr * Lt * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * mm - 4 * square(Ls) * Lt * mb * square(mt) * sin(get_bla() - get_mla()) * square(get_d_bla()) +2 * square(Ls) * Lt * mb * square(mt) * sin(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) * square(get_d_bla()) + 2 * square(Ls) * Lt * mb * square(mt) * sin(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) * square(get_d_bla()) - 2 * Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bla() - get_mla())) * square(get_d_mla()) +Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bla() + get_bra() - get_mla() - get_mra())) * square(get_d_mla()) + Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bla() - get_bra() - get_mla() + get_mra())) * square(get_d_mla()) + 4 * kml * Ls * mA * mb * mt + 4 * kt * Ls * mb * mt * tA +4 * bA * kbl * Lt * mb * mt * cos(get_bla() - get_mla()) +4 * kml * Lt * mA * mb * mt * cos(get_bla() - get_mla()) -2 * kmr * Lt * mA * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) +2 * kmr * Lt * mA * mb * mt * cos(get_bra() + get_mla()) -4 * kml * Ls * mA * mb * mt * cos(2 * (get_bra() - get_mra())) -4 * kt * Ls * mb * mt * tA * cos(2 * (get_bra() - get_mra())) -2 * kmr * Ls * mA * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) +2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) +2 * kmr * Ls * mA * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) -2 * kt * Ls * mb * mt * tA * cos(2 * get_bra() + get_mla() - get_mra()) +2 * kmr * Ls * mA * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) -2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() - get_mla() + get_mra()) -2 * kmr * Ls * mA * mb * mt * cos(get_mla() + get_mra()) +2 * kt * Ls * mb * mt * tA * cos(get_mla() + get_mra()) +2 * kmr * Lt * mA * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) -2 * kmr * get_bra() * (2 * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) -6 * Ls * cos(get_mla() + get_mra()) * square(mm) -2 * Lt * cos(get_bra() - get_mla() - 2 * get_mra()) * square(mm) +2 * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * mm +2 * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * mm +2 * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * mm -4 * Ls * mb * cos(get_mla() + get_mra()) * mm -2 * Ls * mt * cos(get_mla() + get_mra()) * mm +Lt * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * mm -2 * Lt * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * mm -Lt * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * mm -Lt * (mb + mm) * mt * cos(2 * get_bla() + get_bra() - get_mla()) +Lt * (mb + mm) * (2 * mm + mt) * cos(get_bra() + get_mla()) -Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) +Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) +Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) -Ls * mb * mt * cos(get_mla() + get_mra()) +Lt * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) -Lt * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra())) -2 * bA * kbl * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) -2 * kml * Lt * mA * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +2 * get_bla() * (-6 * kml * Ls * square(mm) +2 * kml * Ls * cos(2 * (get_bla() + get_mra())) * square(mm) +2 * kbl * Lt * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) +2 * kml * Lt * cos(get_bla() + get_mla() + 2 * get_mra()) * square(mm) -4 * kml * Ls * mb * mm - 4 * kml * Ls * mt * mm +2 * kml * Ls * mb * cos(2 * (get_bra() - get_mra())) * mm +2 * kml * Ls * mb * cos(2 * (get_bla() + get_mra())) * mm +2 * kbl * Lt * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm +2 * kml * Lt * mb * cos(get_bla() + get_mla() + 2 * get_mra()) * mm -2 * kml * Ls * mb * mt -2 * (kbl + kml) * Lt * (mb * (mm + mt) + mm * (mm + 2 * mt)) * cos(get_bla() - get_mla()) +2 * kml * Ls * mb * mt * cos(2 * (get_bra() - get_mra())) +kbl * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) +kml * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) + (kbl +kml) * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra())) -2 * kmr * Lt * mA * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) -2 * bA * kbl * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) -2 * kml * Lt * mA * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) +4 * kml * Ls * mb * mt * get_mla() + 4 * kt * Ls * mb * mt * get_mla() +4 * kml * Lt * mb * mt * cos(get_bla() - get_mla()) * get_mla() -4 * kml * Ls * mb * mt * cos(2 * (get_bra() - get_mra())) * get_mla() -4 * kt * Ls * mb * mt * cos(2 * (get_bra() - get_mra())) * get_mla() +2 * kt * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mla() - 2 * kt * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() -2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() +2 * kt * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mla() -2 * kml * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - get_mla() + 2 * get_mra()) * get_mla() - 2 * kml * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mla() - 2 * get_mra()) * get_mla() -4 * kt * Ls * mb * mt * get_mra() -2 * kmr * Lt * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mra() +2 * kmr * Lt * mb * mt * cos(get_bra() + get_mla()) * get_mra() +4 * kt * Ls * mb * mt * cos(2 * (get_bra() - get_mra())) * get_mra() -2 * kmr * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mra() - 2 * kt * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mra() +2 * kmr * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() +2 * kmr * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() -2 * kmr * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mra() -2 * kt * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mra() +2 * kmr * Lt * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mra() - 2 * kmr * Lt * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra())/(Ls * square(Lt) * (-4 * cos(2 * (get_mla() + get_mra())) * cube(mm) + 4 * cube(mm) +4 * mb * square(mm) + 12 * mt * square(mm) -4 * mb * cos(2 * (get_mla() + get_mra())) * square(mm) + 4 * square(mt) * mm +8 * mb * mt * mm + 2 * mb * square(mt) -2 * mt * (2 * mm * (mm + mt) + mb * (2 * mm + mt)) * cos(2 * (get_bla() - get_mla())) -2 * mb * mt * (2 * mm + mt) * cos(2 * (get_bra() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() + get_bra() - get_mla() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() - get_bra() - get_mla() + get_mra()))));
}

double Dynein::get_dd_mra() {
	return -(4 * square(Ls) * Lt * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_bla()) * cube(mm) -4 * square(Ls) * Lt * sin(get_bla() + get_mra()) * square(get_d_bla()) * cube(mm) -8 * Ls * square(Lt) * sin(get_mla() + get_mra()) * square(get_d_mla()) * cube(mm) +4 * Ls * square(Lt) * sin(2 * (get_mla() + get_mra())) * square(get_d_mra()) * cube(mm) +4 * square(Ls) * Lt * mb * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_bla()) * square(mm) +4 * square(Ls) * Lt * mt * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_bla()) * square(mm) -4 * square(Ls) * Lt * mb * sin(get_bla() + get_mra()) * square(get_d_bla()) * square(mm) -4 * square(Ls) * Lt * mt * sin(get_bla() + get_mra()) * square(get_d_bla()) * square(mm) -4 * square(Ls) * Lt * mb * sin(get_bra() - get_mra()) * square(get_d_bra()) * square(mm) +4 * square(Ls) * Lt * mb * sin(get_bra() + 2 * get_mla() + get_mra()) * square(get_d_bra()) * square(mm) -8 * Ls * square(Lt) * mb * sin(get_mla() + get_mra()) * square(get_d_mla()) * square(mm) -8 * Ls * square(Lt) * mt * sin(get_mla() + get_mra()) * square(get_d_mla()) * square(mm) +4 * Ls * square(Lt) * mb * sin(2 * (get_mla() + get_mra())) * square(get_d_mra()) * square(mm) + 12 * kmr * Ls * mA * square(mm) - 12 * kt * Ls * tA * square(mm) -4 * kmr * Ls * mA * cos(2 * (get_bla() - get_mla())) * square(mm) +4 * kt * Ls * tA * cos(2 * (get_bla() - get_mla())) * square(mm) +4 * kmr * Lt * mA * cos(get_bra() - get_mra()) * square(mm) -4 * bA * kbl * Lt * cos(get_bla() - 2 * get_mla() - get_mra()) * square(mm) -4 * kml * Lt * mA * cos(get_bla() - 2 * get_mla() - get_mra()) * square(mm) +4 * bA * kbl * Lt * cos(get_bla() + get_mra()) * square(mm) +4 * kml * Lt * mA * cos(get_bla() + get_mra()) * square(mm) +4 * kml * Ls * mA * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) +4 * kt * Ls * tA * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) -12 * kml * Ls * mA * cos(get_mla() + get_mra()) * square(mm) -12 * kt * Ls * tA * cos(get_mla() + get_mra()) * square(mm) -4 * kmr * Lt * mA * cos(get_bra() + 2 * get_mla() + get_mra()) * square(mm) -12 * kt * Ls * get_mla() * square(mm) +4 * kt * Ls * cos(2 * (get_bla() - get_mla())) * get_mla() * square(mm) -4 * kml * Lt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mla() * square(mm) +4 * kml * Lt * cos(get_bla() + get_mra()) * get_mla() * square(mm) +4 * kml * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * square(mm) +4 * kt * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * square(mm) -12 * kml * Ls * cos(get_mla() + get_mra()) * get_mla() * square(mm) -12 * kt * Ls * cos(get_mla() + get_mra()) * get_mla() * square(mm) +12 * kmr * Ls * get_mra() * square(mm) + 12 * kt * Ls * get_mra() * square(mm) -4 * kmr * Ls * cos(2 * (get_bla() - get_mla())) * get_mra() * square(mm) -4 * kt * Ls * cos(2 * (get_bla() - get_mla())) * get_mra() * square(mm) +4 * kmr * Lt * cos(get_bra() - get_mra()) * get_mra() * square(mm) -4 * kt * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * square(mm) +12 * kt * Ls * cos(get_mla() + get_mra()) * get_mra() * square(mm) -4 * kmr * Lt * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * square(mm) +2 * square(Ls) * Lt * mb * mt * sin(get_bla() + 2 * get_bra() - get_mra()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * mb * mt * sin(get_bla() - 2 * get_mla() - get_mra()) * square(get_d_bla()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() + get_mra()) * square(get_d_bla()) * mm -2 * square(Ls) * Lt * mb * mt * sin(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) * square(get_d_bla()) * mm -12 * square(Ls) * Lt * mb * mt * sin(get_bra() - get_mra()) * square(get_d_bra()) * mm +2 * square(Ls) * Lt * mb * mt * sin(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * square(get_d_bra()) * mm -2 * square(Ls) * Lt * mb * mt * sin(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * square(get_d_bra()) * mm +4 * Ls * square(Lt) * mb * mt * sin(2 * get_bra() + get_mla() - get_mra()) * square(get_d_mla()) * mm -4 * Ls * square(Lt) * mb * mt * sin(get_mla() + get_mra()) * square(get_d_mla()) * mm -4 * Ls * square(Lt) * mb * mt * sin(2 * (get_bra() - get_mra())) * square(get_d_mra()) * mm + 8 * kmr * Ls * mA * mb * mm + 16 * kmr * Ls * mA * mt * mm -8 * kt * Ls * mb * tA * mm - 16 * kt * Ls * mt * tA * mm -4 * kmr * Ls * mA * mb * cos(2 * (get_bla() - get_mla())) * mm -8 * kmr * Ls * mA * mt * cos(2 * (get_bla() - get_mla())) * mm +4 * kt * Ls * mb * tA * cos(2 * (get_bla() - get_mla())) * mm +8 * kt * Ls * mt * tA * cos(2 * (get_bla() - get_mla())) * mm -4 * kmr * Ls * mA * mb * cos(2 * (get_bra() + get_mla())) * mm +4 * kt * Ls * mb * tA * cos(2 * (get_bra() + get_mla())) * mm +4 * kmr * Lt * mA * mb * cos(get_bra() - get_mra()) * mm +12 * kmr * Lt * mA * mt * cos(get_bra() - get_mra()) * mm +4 * kml * Ls * mA * mb * cos(2 * get_bra() + get_mla() - get_mra()) * mm +4 * kt * Ls * mb * tA * cos(2 * get_bra() + get_mla() - get_mra()) * mm -4 * bA * kbl * Lt * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * kml * Lt * mA * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * bA * kbl * Lt * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -4 * kml * Lt * mA * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * mm -2 * kmr * Lt * mA * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * mm +4 * bA * kbl * Lt * mb * cos(get_bla() + get_mra()) * mm +4 * kml * Lt * mA * mb * cos(get_bla() + get_mra()) * mm +4 * bA * kbl * Lt * mt * cos(get_bla() + get_mra()) * mm +4 * kml * Lt * mA * mt * cos(get_bla() + get_mra()) * mm +4 * kml * Ls * mA * mb * cos(2 * get_bla() - get_mla() + get_mra()) * mm +4 * kml * Ls * mA * mt * cos(2 * get_bla() - get_mla() + get_mra()) * mm +4 * kt * Ls * mb * tA * cos(2 * get_bla() - get_mla() + get_mra()) * mm +4 * kt * Ls * mt * tA * cos(2 * get_bla() - get_mla() + get_mra()) * mm -8 * kml * Ls * mA * mb * cos(get_mla() + get_mra()) * mm -4 * kml * Ls * mA * mt * cos(get_mla() + get_mra()) * mm -8 * kt * Ls * mb * tA * cos(get_mla() + get_mra()) * mm -4 * kt * Ls * mt * tA * cos(get_mla() + get_mra()) * mm -4 * kmr * Lt * mA * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * mm -2 * kmr * Lt * mA * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * mm -8 * kt * Ls * mb * get_mla() * mm - 16 * kt * Ls * mt * get_mla() * mm +4 * kt * Ls * mb * cos(2 * (get_bla() - get_mla())) * get_mla() * mm +8 * kt * Ls * mt * cos(2 * (get_bla() - get_mla())) * get_mla() * mm +4 * kt * Ls * mb * cos(2 * (get_bra() + get_mla())) * get_mla() * mm +4 * kml * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() * mm +4 * kt * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() * mm -4 * kml * Lt * mb * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mla() * mm -4 * kml * Lt * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mla() * mm +4 * kml * Lt * mb * cos(get_bla() + get_mra()) * get_mla() * mm +4 * kml * Lt * mt * cos(get_bla() + get_mra()) * get_mla() * mm +4 * kml * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm +4 * kt * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm +4 * kml * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm +4 * kt * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() * mm -8 * kml * Ls * mb * cos(get_mla() + get_mra()) * get_mla() * mm -8 * kt * Ls * mb * cos(get_mla() + get_mra()) * get_mla() * mm -4 * kml * Ls * mt * cos(get_mla() + get_mra()) * get_mla() * mm -4 * kt * Ls * mt * cos(get_mla() + get_mra()) * get_mla() * mm +8 * kmr * Ls * mb * get_mra() * mm + 8 * kt * Ls * mb * get_mra() * mm +16 * kmr * Ls * mt * get_mra() * mm + 16 * kt * Ls * mt * get_mra() * mm -4 * kmr * Ls * mb * cos(2 * (get_bla() - get_mla())) * get_mra() * mm -4 * kt * Ls * mb * cos(2 * (get_bla() - get_mla())) * get_mra() * mm -8 * kmr * Ls * mt * cos(2 * (get_bla() - get_mla())) * get_mra() * mm -8 * kt * Ls * mt * cos(2 * (get_bla() - get_mla())) * get_mra() * mm -4 * kmr * Ls * mb * cos(2 * (get_bra() + get_mla())) * get_mra() * mm -4 * kt * Ls * mb * cos(2 * (get_bra() + get_mla())) * get_mra() * mm +4 * kmr * Lt * mb * cos(get_bra() - get_mra()) * get_mra() * mm +12 * kmr * Lt * mt * cos(get_bra() - get_mra()) * get_mra() * mm -4 * kt * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() * mm -2 * kmr * Lt * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() * mm - 4 * kt * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm - 4 * kt * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() * mm + 8 * kt * Ls * mb * cos(get_mla() + get_mra()) * get_mra() * mm +4 * kt * Ls * mt * cos(get_mla() + get_mra()) * get_mra() * mm -4 * kmr * Lt * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * mm -2 * kmr * Lt * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() * mm + 4 * kmr * Ls * mA * square(mt) -4 * square(Ls) * Lt * mb * square(mt) * sin(get_bra() - get_mra()) * square(get_d_bra()) + 2 * square(Ls) * Lt * mb * square(mt) * sin(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * square(get_d_bra()) - 2 * square(Ls) * Lt * mb * square(mt) * sin(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * square(get_d_bra()) - 2 * Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bra() - get_mra())) * square(get_d_mra()) +Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bla() + get_bra() - get_mla() - get_mra())) * square(get_d_mra()) - Ls * square(Lt) * mb * square(mt) * sin(2 * (get_bla() - get_bra() - get_mla() + get_mra())) * square(get_d_mra()) + 4 * kmr * Ls * mA * mb * mt - 4 * kt * Ls * square(mt) * tA -4 * kt * Ls * mb * mt * tA - 4 * kmr * Ls * mA * square(mt) * cos(2 * (get_bla() - get_mla())) -4 * kmr * Ls * mA * mb * mt * cos(2 * (get_bla() - get_mla())) +4 * kt * Ls * square(mt) * tA * cos(2 * (get_bla() - get_mla())) +4 * kt * Ls * mb * mt * tA * cos(2 * (get_bla() - get_mla())) +4 * kmr * Lt * mA * square(mt) * cos(get_bra() - get_mra()) +4 * kmr * Lt * mA * mb * mt * cos(get_bra() - get_mra()) -2 * bA * kbl * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) -2 * kml * Lt * mA * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) -2 * kml * Ls * mA * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) -2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) +2 * kml * Ls * mA * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) +2 * kt * Ls * mb * mt * tA * cos(2 * get_bra() + get_mla() - get_mra()) -2 * bA * kbl * Lt * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) -2 * kml * Lt * mA * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) -2 * kmr * Lt * mA * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) -2 * kmr * Lt * mA * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +2 * bA * kbl * Lt * mb * mt * cos(get_bla() + get_mra()) +2 * kml * Lt * mA * mb * mt * cos(get_bla() + get_mra()) +2 * kml * Ls * mA * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) +2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() - get_mla() + get_mra()) -2 * kml * Ls * mA * mb * mt * cos(get_mla() + get_mra()) -2 * kt * Ls * mb * mt * tA * cos(get_mla() + get_mra()) -2 * get_bla() * (2 * kbl * Lt * cos(get_bla() + get_mra()) * square(mm) +2 * kml * Lt * cos(get_bla() + get_mra()) * square(mm) +2 * kml * Ls * cos(2 * get_bla() - get_mla() + get_mra()) * square(mm) -6 * kml * Ls * cos(get_mla() + get_mra()) * square(mm) +2 * kml * Ls * mb * cos(2 * get_bra() + get_mla() - get_mra()) * mm +2 * kbl * Lt * mb * cos(get_bla() + get_mra()) * mm +2 * kml * Lt * mb * cos(get_bla() + get_mra()) * mm +2 * kbl * Lt * mt * cos(get_bla() + get_mra()) * mm +2 * kml * Lt * mt * cos(get_bla() + get_mra()) * mm +2 * kml * Ls * mb * cos(2 * get_bla() - get_mla() + get_mra()) * mm +2 * kml * Ls * mt * cos(2 * get_bla() - get_mla() + get_mra()) * mm -4 * kml * Ls * mb * cos(get_mla() + get_mra()) * mm -2 * kml * Ls * mt * cos(get_mla() + get_mra()) * mm - (kbl + kml) * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) -kml * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) +kml * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) - (kbl +kml) * Lt * (2 * mm * (mm + mt) + mb * (2 * mm + mt)) * cos(get_bla() - 2 * get_mla() - get_mra()) +kbl * Lt * mb * mt * cos(get_bla() + get_mra()) +kml * Lt * mb * mt * cos(get_bla() + get_mra()) +kml * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) -kml * Ls * mb * mt * cos(get_mla() + get_mra()) +kbl * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) +kml * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra())) -2 * kmr * Lt * mA * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) -2 * kmr * Lt * mA * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) +2 * kmr * get_bra() * (-6 * Ls * square(mm) - 2 * Lt * cos(get_bra() - get_mra()) * square(mm) +2 * Lt * cos(get_bra() + 2 * get_mla() + get_mra()) * square(mm) - 4 * Ls * mb * mm -8 * Ls * mt * mm + 2 * Ls * mb * cos(2 * (get_bra() + get_mla())) * mm -2 * Lt * mb * cos(get_bra() - get_mra()) * mm -6 * Lt * mt * cos(get_bra() - get_mra()) * mm +Lt * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * mm +2 * Lt * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * mm +Lt * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * mm -2 * Ls * square(mt) - 2 * Ls * mb * mt +2 * Ls * (mm + mt) * (mb + mm + mt) * cos(2 * (get_bla() - get_mla())) -2 * Lt * square(mt) * cos(get_bra() - get_mra()) -2 * Lt * mb * mt * cos(get_bra() - get_mra()) +Lt * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +Lt * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +Lt * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) +Lt * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra())) +2 * bA * kbl * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) +2 * kml * Lt * mA * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) -4 * kt * Ls * square(mt) * get_mla() - 4 * kt * Ls * mb * mt * get_mla() +4 * kt * Ls * square(mt) * cos(2 * (get_bla() - get_mla())) * get_mla() +4 * kt * Ls * mb * mt * cos(2 * (get_bla() - get_mla())) * get_mla() -2 * kml * Lt * mb * mt * cos(get_bla() + 2 * get_bra() - get_mra()) * get_mla() -2 * kml * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mla() - 2 * kt * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mla() +2 * kml * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() +2 * kt * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mla() -2 * kml * Lt * mb * mt * cos(get_bla() - 2 * get_mla() - get_mra()) * get_mla() +2 * kml * Lt * mb * mt * cos(get_bla() + get_mra()) * get_mla() +2 * kml * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() +2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mla() -2 * kml * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mla() -2 * kt * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mla() +2 * kml * Lt * mb * mt * cos(get_bla() - 2 * get_bra() - 2 * get_mla() + get_mra()) * get_mla() + 4 * kmr * Ls * square(mt) * get_mra() + 4 * kt * Ls * square(mt) * get_mra() +4 * kmr * Ls * mb * mt * get_mra() + 4 * kt * Ls * mb * mt * get_mra() -4 * kmr * Ls * square(mt) * cos(2 * (get_bla() - get_mla())) * get_mra() -4 * kt * Ls * square(mt) * cos(2 * (get_bla() - get_mla())) * get_mra() -4 * kmr * Ls * mb * mt * cos(2 * (get_bla() - get_mla())) * get_mra() -4 * kt * Ls * mb * mt * cos(2 * (get_bla() - get_mla())) * get_mra() +4 * kmr * Lt * square(mt) * cos(get_bra() - get_mra()) * get_mra() +4 * kmr * Lt * mb * mt * cos(get_bra() - get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(2 * get_bla() + 2 * get_bra() - get_mla() - get_mra()) * get_mra() - 2 * kt * Ls * mb * mt * cos(2 * get_bra() + get_mla() - get_mra()) * get_mra() -2 * kmr * Lt * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() - 2 * kmr * Lt * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() -2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_mla() + get_mra()) * get_mra() +2 * kt * Ls * mb * mt * cos(get_mla() + get_mra()) * get_mra() -2 * kmr * Lt * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() -2 * kmr * Lt * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra())/(Ls * square(Lt) * (-4 * cos(2 * (get_mla() + get_mra())) * cube(mm) + 4 * cube(mm) +4 * mb * square(mm) + 12 * mt * square(mm) -4 * mb * cos(2 * (get_mla() + get_mra())) * square(mm) + 4 * square(mt) * mm +8 * mb * mt * mm + 2 * mb * square(mt) -2 * mt * (2 * mm * (mm + mt) + mb * (2 * mm + mt)) * cos(2 * (get_bla() - get_mla())) -2 * mb * mt * (2 * mm + mt) * cos(2 * (get_bra() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() + get_bra() - get_mla() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() - get_bra() - get_mla() + get_mra()))));
}

double Dynein::get_dd_bra() {
	return -(-4 * kmr * Lt * mA * cube(mm) +4 * kmr * Lt * mA * cos(2 * (get_mla() + get_mra())) * cube(mm) -4 * kmr * Lt * get_mra() * cube(mm) +4 * kmr * Lt * cos(2 * (get_mla() + get_mra())) * get_mra() * cube(mm) -2 * square(Ls) * Lt * mb * mt * sin(get_bla() + get_bra()) * square(get_d_bla()) * square(mm) +2 * square(Ls) * Lt * mb * mt * sin(get_bla() - get_bra() - 2 * get_mla()) * square(get_d_bla()) * square(mm) +2 * square(Ls) * Lt * mb * mt * sin(get_bla() - get_bra() + 2 * get_mra()) * square(get_d_bla()) * square(mm) -2 * square(Ls) * Lt * mb * mt * sin(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * square(get_d_bla()) * square(mm) -4 * Ls * square(Lt) * mb * mt * sin(get_bra() + get_mla()) * square(get_d_mla()) * square(mm) -4 * Ls * square(Lt) * mb * mt * sin(get_bra() - get_mla() - 2 * get_mra()) * square(get_d_mla()) * square(mm) +8 * Ls * square(Lt) * mb * mt * sin(get_bra() - get_mra()) * square(get_d_mra()) * square(mm) - 8 * kmr * Lt * mA * mb * square(mm) - 12 * kmr * Lt * mA * mt * square(mm) +4 * kmr * Lt * mA * mt * cos(2 * (get_bla() - get_mla())) * square(mm) -4 * kml * Ls * mA * mb * cos(get_bra() + get_mla()) * square(mm) -4 * kt * Ls * mb * tA * cos(get_bra() + get_mla()) * square(mm) -4 * kmr * Ls * mA * mb * cos(get_bra() - get_mra()) * square(mm) +4 * kt * Ls * mb * tA * cos(get_bra() - get_mra()) * square(mm) +8 * kmr * Lt * mA * mb * cos(2 * (get_mla() + get_mra())) * square(mm) +4 * kmr * Ls * mA * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * square(mm) -4 * kt * Ls * mb * tA * cos(get_bra() + 2 * get_mla() + get_mra()) * square(mm) +4 * kml * Ls * mA * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * square(mm) +4 * kt * Ls * mb * tA * cos(get_bra() - get_mla() - 2 * get_mra()) * square(mm) -4 * kml * Ls * mb * cos(get_bra() + get_mla()) * get_mla() * square(mm) -4 * kt * Ls * mb * cos(get_bra() + get_mla()) * get_mla() * square(mm) +4 * kt * Ls * mb * cos(get_bra() - get_mra()) * get_mla() * square(mm) -4 * kt * Ls * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mla() * square(mm) +4 * kml * Ls * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * square(mm) +4 * kt * Ls * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * square(mm) -8 * kmr * Lt * mb * get_mra() * square(mm) - 12 * kmr * Lt * mt * get_mra() * square(mm) +4 * kmr * Lt * mt * cos(2 * (get_bla() - get_mla())) * get_mra() * square(mm) +4 * kt * Ls * mb * cos(get_bra() + get_mla()) * get_mra() * square(mm) -4 * kmr * Ls * mb * cos(get_bra() - get_mra()) * get_mra() * square(mm) -4 * kt * Ls * mb * cos(get_bra() - get_mra()) * get_mra() * square(mm) +8 * kmr * Lt * mb * cos(2 * (get_mla() + get_mra())) * get_mra() * square(mm) +4 * kmr * Ls * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * square(mm) +4 * kt * Ls * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * square(mm) -4 * kt * Ls * mb * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * square(mm) -4 * kmr * Lt * mA * square(mb) * mm - 4 * kmr * Lt * mA * square(mt) * mm -2 * square(Ls) * Lt * square(mb) * mt * sin(get_bla() + get_bra()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * square(mb) * mt * sin(get_bla() - get_bra() - 2 * get_mla()) * square(get_d_bla()) * mm +2 * square(Ls) * Lt * square(mb) * mt * sin(get_bla() - get_bra() + 2 * get_mra()) * square(get_d_bla()) * mm -2 * square(Ls) * Lt * square(mb) * mt * sin(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * square(get_d_bla()) * mm +4 * square(Ls) * Lt * square(mb) * mt * sin(2 * (get_bra() - get_mra())) * square(get_d_bra()) * mm -4 * Ls * square(Lt) * square(mb) * mt * sin(get_bra() + get_mla()) * square(get_d_mla()) * mm -4 * Ls * square(Lt) * square(mb) * mt * sin(get_bra() - get_mla() - 2 * get_mra()) * square(get_d_mla()) * mm +4 * Ls * square(Lt) * mb * square(mt) * sin(get_bra() - get_mra()) * square(get_d_mra()) * mm +8 * Ls * square(Lt) * square(mb) * mt * sin(get_bra() - get_mra()) * square(get_d_mra()) * mm -2 * Ls * square(Lt) * mb * square(mt) * sin(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * square(get_d_mra()) * mm +2 * Ls * square(Lt) * mb * square(mt) * sin(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * square(get_d_mra()) * mm - 16 * kmr * Lt * mA * mb * mt * mm +2 * bA * kbl * Lt * mb * mt * cos(get_bla() + get_bra()) * mm +2 * kml * Lt * mA * mb * mt * cos(get_bla() + get_bra()) * mm +4 * kmr * Lt * mA * square(mt) * cos(2 * (get_bla() - get_mla())) * mm +8 * kmr * Lt * mA * mb * mt * cos(2 * (get_bla() - get_mla())) * mm +2 * kml * Ls * mA * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) * mm +2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() + get_bra() - get_mla()) * mm -4 * kml * Ls * mA * square(mb) * cos(get_bra() + get_mla()) * mm -2 * kml * Ls * mA * mb * mt * cos(get_bra() + get_mla()) * mm -4 * kt * Ls * square(mb) * tA * cos(get_bra() + get_mla()) * mm -2 * kt * Ls * mb * mt * tA * cos(get_bra() + get_mla()) * mm -2 * bA * kbl * Lt * mb * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * mm -2 * kml * Lt * mA * mb * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * mm -4 * kmr * Ls * mA * square(mb) * cos(get_bra() - get_mra()) * mm -12 * kmr * Ls * mA * mb * mt * cos(get_bra() - get_mra()) * mm +4 * kt * Ls * square(mb) * tA * cos(get_bra() - get_mra()) * mm +12 * kt * Ls * mb * mt * tA * cos(get_bra() - get_mra()) * mm +2 * kmr * Ls * mA * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * mm -2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * mm +4 * kmr * Lt * mA * square(mb) * cos(2 * (get_mla() + get_mra())) * mm +4 * kmr * Ls * mA * square(mb) * cos(get_bra() + 2 * get_mla() + get_mra()) * mm -4 * kt * Ls * square(mb) * tA * cos(get_bra() + 2 * get_mla() + get_mra()) * mm +2 * kmr * Ls * mA * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * mm -2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * mm -2 * bA * kbl * Lt * mb * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * mm -2 * kml * Lt * mA * mb * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * mm -2 * kml * Ls * mA * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * mm -2 * kt * Ls * mb * mt * tA * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * mm +4 * kml * Ls * mA * square(mb) * cos(get_bra() - get_mla() - 2 * get_mra()) * mm +2 * kml * Ls * mA * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * mm +4 * kt * Ls * square(mb) * tA * cos(get_bra() - get_mla() - 2 * get_mra()) * mm +2 * kt * Ls * mb * mt * tA * cos(get_bra() - get_mla() - 2 * get_mra()) * mm +2 * bA * kbl * Lt * mb * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * mm +2 * kml * Lt * mA * mb * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * mm +2 * kml * Lt * mb * mt * cos(get_bla() + get_bra()) * get_mla() * mm +2 * kml * Ls * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mla() * mm +2 * kt * Ls * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mla() * mm -4 * kml * Ls * square(mb) * cos(get_bra() + get_mla()) * get_mla() * mm -4 * kt * Ls * square(mb) * cos(get_bra() + get_mla()) * get_mla() * mm -2 * kml * Ls * mb * mt * cos(get_bra() + get_mla()) * get_mla() * mm -2 * kt * Ls * mb * mt * cos(get_bra() + get_mla()) * get_mla() * mm -2 * kml * Lt * mb * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * get_mla() * mm +4 * kt * Ls * square(mb) * cos(get_bra() - get_mra()) * get_mla() * mm +12 * kt * Ls * mb * mt * cos(get_bra() - get_mra()) * get_mla() * mm -2 * kt * Ls * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mla() * mm - 4 * kt * Ls * square(mb) * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mla() * mm - 2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mla() * mm -2 * kml * Lt * mb * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * get_mla() * mm -2 * kml * Ls * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mla() * mm - 2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mla() * mm +4 * kml * Ls * square(mb) * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * mm +4 * kt * Ls * square(mb) * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * mm +2 * kml * Ls * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * mm +2 * kt * Ls * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() * mm +2 * kml * Lt * mb * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * get_mla() * mm - 4 * kmr * Lt * square(mb) * get_mra() * mm - 4 * kmr * Lt * square(mt) * get_mra() * mm -16 * kmr * Lt * mb * mt * get_mra() * mm +4 * kmr * Lt * square(mt) * cos(2 * (get_bla() - get_mla())) * get_mra() * mm +8 * kmr * Lt * mb * mt * cos(2 * (get_bla() - get_mla())) * get_mra() * mm -2 * kt * Ls * mb * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mra() * mm +4 * kt * Ls * square(mb) * cos(get_bra() + get_mla()) * get_mra() * mm +2 * kt * Ls * mb * mt * cos(get_bra() + get_mla()) * get_mra() * mm -4 * kmr * Ls * square(mb) * cos(get_bra() - get_mra()) * get_mra() * mm -4 * kt * Ls * square(mb) * cos(get_bra() - get_mra()) * get_mra() * mm -12 * kmr * Ls * mb * mt * cos(get_bra() - get_mra()) * get_mra() * mm -12 * kt * Ls * mb * mt * cos(get_bra() - get_mra()) * get_mra() * mm +2 * kmr * Ls * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() * mm + 2 * kt * Ls * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() * mm +4 * kmr * Lt * square(mb) * cos(2 * (get_mla() + get_mra())) * get_mra() * mm +4 * kmr * Ls * square(mb) * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * mm +4 * kt * Ls * square(mb) * cos(get_bra() + 2 * get_mla() + get_mra()) * get_mra() * mm +2 * kmr * Ls * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() * mm + 2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() * mm +2 * kt * Ls * mb * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mra() * mm - 4 * kt * Ls * square(mb) * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * mm -2 * kt * Ls * mb * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() * mm -4 * kmr * Lt * mA * mb * square(mt) +2 * square(Ls) * Lt * square(mb) * square(mt) * sin(2 * (get_bra() - get_mra())) * square(get_d_bra()) -square(Ls) * Lt * square(mb) * square(mt) * sin(2 * (get_bla() + get_bra() - get_mla() - get_mra())) * square(get_d_bra()) + square(Ls) * Lt * square(mb) * square(mt) * sin(2 * (get_bla() - get_bra() - get_mla() + get_mra())) * square(get_d_bra()) + 4 * Ls * square(Lt) * square(mb) * square(mt) * sin(get_bra() - get_mra()) * square(get_d_mra()) -2 * Ls * square(Lt) * square(mb) * square(mt) * sin(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * square(get_d_mra()) + 2 * Ls * square(Lt) * square(mb) * square(mt) * sin(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * square(get_d_mra()) - 4 * kmr * Lt * mA * square(mb) * mt +2 * bA * kbl * Lt * square(mb) * mt * cos(get_bla() + get_bra()) +2 * kml * Lt * mA * square(mb) * mt * cos(get_bla() + get_bra()) +4 * kmr * Lt * mA * mb * square(mt) * cos(2 * (get_bla() - get_mla())) +4 * kmr * Lt * mA * square(mb) * mt * cos(2 * (get_bla() - get_mla())) +2 * kml * Ls * mA * square(mb) * mt * cos(2 * get_bla() + get_bra() - get_mla()) +2 * kt * Ls * square(mb) * mt * tA * cos(2 * get_bla() + get_bra() - get_mla()) -2 * kml * Ls * mA * square(mb) * mt * cos(get_bra() + get_mla()) -2 * kt * Ls * square(mb) * mt * tA * cos(get_bra() + get_mla()) -2 * bA * kbl * Lt * square(mb) * mt * cos(get_bla() - get_bra() - 2 * get_mla()) -2 * kml * Lt * mA * square(mb) * mt * cos(get_bla() - get_bra() - 2 * get_mla()) -4 * kmr * Ls * mA * mb * square(mt) * cos(get_bra() - get_mra()) -4 * kmr * Ls * mA * square(mb) * mt * cos(get_bra() - get_mra()) +4 * kt * Ls * mb * square(mt) * tA * cos(get_bra() - get_mra()) +4 * kt * Ls * square(mb) * mt * tA * cos(get_bra() - get_mra()) +2 * kmr * Ls * mA * mb * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +2 * kmr * Ls * mA * square(mb) * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) -2 * kt * Ls * mb * square(mt) * tA * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) -2 * kt * Ls * square(mb) * mt * tA * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +2 * kmr * Ls * mA * mb * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) +2 * kmr * Ls * mA * square(mb) * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) -2 * kt * Ls * mb * square(mt) * tA * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) -2 * kt * Ls * square(mb) * mt * tA * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) -2 * kmr * get_bra() * (-2 * Lt * cube(mm) + 2 * Lt * cos(2 * (get_mla() + get_mra())) * cube(mm) -4 * Lt * mb * square(mm) - 6 * Lt * mt * square(mm) +4 * Lt * mb * cos(2 * (get_mla() + get_mra())) * square(mm) +2 * Ls * mb * cos(get_bra() + 2 * get_mla() + get_mra()) * square(mm) -2 * Lt * square(mb) * mm - 2 * Lt * square(mt) * mm - 8 * Lt * mb * mt * mm +Ls * mb * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * mm +2 * Lt * square(mb) * cos(2 * (get_mla() + get_mra())) * mm +2 * Ls * square(mb) * cos(get_bra() + 2 * get_mla() + get_mra()) * mm +Ls * mb * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * mm -2 * Lt * mb * square(mt) - 2 * Lt * square(mb) * mt +2 * Lt * (mb + mm) * mt * (mb + mm + mt) * cos(2 * (get_bla() - get_mla())) -2 * Ls * mb * square((mm) + 3 * mt * mm + square(mt) + mb * (mm + mt)) * cos(get_bra() - get_mra()) +Ls * mb * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) +Ls * mb * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) +Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra())) -2 * bA * kbl * Lt * square(mb) * mt * cos(get_bla() - get_bra() + 2 * get_mra()) -2 * kml * Lt * mA * square(mb) * mt * cos(get_bla() - get_bra() + 2 * get_mra()) -2 * kml * Ls * mA * square(mb) * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) -2 * kt * Ls * square(mb) * mt * tA * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) +2 * kml * Ls * mA * square(mb) * mt * cos(get_bra() - get_mla() - 2 * get_mra()) +2 * kt * Ls * square(mb) * mt * tA * cos(get_bra() - get_mla() - 2 * get_mra()) +2 * bA * kbl * Lt * square(mb) * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) +2 * kml * Lt * mA * square(mb) * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) +2 * kml * Lt * square(mb) * mt * cos(get_bla() + get_bra()) * get_mla() +2 * kml * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mla() +2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mla() -2 * kml * Ls * square(mb) * mt * cos(get_bra() + get_mla()) * get_mla() -2 * kt * Ls * square(mb) * mt * cos(get_bra() + get_mla()) * get_mla() -2 * kml * Lt * square(mb) * mt * cos(get_bla() - get_bra() - 2 * get_mla()) * get_mla() +4 * kt * Ls * mb * square(mt) * cos(get_bra() - get_mra()) * get_mla() +4 * kt * Ls * square(mb) * mt * cos(get_bra() - get_mra()) * get_mla() -2 * kt * Ls * mb * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mla() - 2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mla() -2 * kt * Ls * mb * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mla() -2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mla() - 2 * kml * Lt * square(mb) * mt * cos(get_bla() - get_bra() + 2 * get_mra()) * get_mla() - 2 * kml * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mla() -2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mla() + 2 * kml * Ls * square(mb) * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() + 2 * kt * Ls * square(mb) * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mla() + 2 * kml * Lt * square(mb) * mt * cos(get_bla() + get_bra() - 2 * (get_mla() + get_mra())) * get_mla() -4 * kmr * Lt * mb * square(mt) * get_mra() - 4 * kmr * Lt * square(mb) * mt * get_mra() +4 * kmr * Lt * mb * square(mt) * cos(2 * (get_bla() - get_mla())) * get_mra() +4 * kmr * Lt * square(mb) * mt * cos(2 * (get_bla() - get_mla())) * get_mra() -2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - get_mla()) * get_mra() +2 * kt * Ls * square(mb) * mt * cos(get_bra() + get_mla()) * get_mra() -4 * kmr * Ls * mb * square(mt) * cos(get_bra() - get_mra()) * get_mra() -4 * kt * Ls * mb * square(mt) * cos(get_bra() - get_mra()) * get_mra() -4 * kmr * Ls * square(mb) * mt * cos(get_bra() - get_mra()) * get_mra() -4 * kt * Ls * square(mb) * mt * cos(get_bra() - get_mra()) * get_mra() +2 * kmr * Ls * mb * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() +2 * kt * Ls * mb * square(mt) * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() + 2 * kmr * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() +2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() + get_bra() - 2 * get_mla() - get_mra()) * get_mra() + 2 * kmr * Ls * mb * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() +2 * kt * Ls * mb * square(mt) * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() + 2 * kmr * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() +2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - 2 * get_mla() + get_mra()) * get_mra() + 2 * kt * Ls * square(mb) * mt * cos(2 * get_bla() - get_bra() - get_mla() + 2 * get_mra()) * get_mra() -2 * kt * Ls * square(mb) * mt * cos(get_bra() - get_mla() - 2 * get_mra()) * get_mra() +4 * mb * (mb + mm) * get_bla() * sin(get_bra() -get_mra()) * ((kbl + kml) * Lt * mt * sin(get_bla() - 2 * get_mla() - get_mra()) + (kbl + kml) * Lt * mt * sin(get_bla() + get_mra()) +kml * Ls * (mt * sin(2 * get_bla() - get_mla() + get_mra()) - (2 * mm + mt) * sin(get_mla() + get_mra()))))/square((Ls) * Lt * mb * (-4 * cos(2 * (get_mla() + get_mra())) * cube(mm) + 4 * cube(mm) + 4 * mb * square(mm) +12 * mt * square(mm) - 4 * mb * cos(2 * (get_mla() + get_mra())) * square(mm) +4 * square(mt) * mm + 8 * mb * mt * mm + 2 * mb * square(mt) -2 * mt * (2 * mm * (mm + mt) + mb * (2 * mm + mt)) * cos(2 * (get_bla() - get_mla())) -2 * mb * mt * (2 * mm + mt) * cos(2 * (get_bra() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() + get_bra() - get_mla() - get_mra())) +mb * square(mt) * cos(2 * (get_bla() - get_bra() - get_mla() + get_mra()))));
}

double Dynein::get_bla() {
	return bla;
}

double Dynein::get_mla() {
	return mla;
}

double Dynein::get_mra() {
	return mra;
}

double Dynein::get_bra() {
	return bra;
}

double Dynein::get_PE() {
	double PE = 0;
	//Add PE code here once you've figured it out
	return PE;
}

void Dynein::log(double t) {
	fprintf(file, "%+.5f\t%+.5f\t%+.5f\t%+.5f\t%+.5f\t%+.5f\t%.3f\t%.2f\t\n", get_blx(), get_bly(), get_bla(), get_mla(), get_mra(), get_bra(), get_PE(), t);	
}

/*** Utility Functions ***/

double Dynein::square(double num) {
	return num * num;
}

double Dynein::cube(double num) {
	return num * num * num;
}

double dist(double x1, double y1, double x2, double y2) {
	return sqrt(pow(x2-x1, 2) + pow(y2-y1, 2));
}

double randAngle(double range) {
	srand(time(NULL));
	return ((((double)(rand() % 1000))/500) - 1) * range;
}

double resetLog() {
	file = fopen("data.txt", "w");
	
	fprintf(file, "blX\t\t\tblY\t\t\tbla\t\t\tmla\t\t\tmra\t\t\tbra\t\t\tPE\t\tt\n");
}

Dynein* initProtein(Dynein* dyn) {
	dyn->set_blx(0);
	dyn->set_bly(0);
	
	dyn->set_bla(bA);
	dyn->set_mla(mA);
	dyn->set_mra(tA);
	dyn->set_bra(bA);
}

Dynein* simulateProtein(Dynein* dyn, double dt, double tf) {
	
	float t = 0;
	
	float temp_bla;
	float temp_mla;
	float temp_mra;
	float temp_bra;
	
	float temp_d_bla = 0;
	float temp_d_mla = 0;
	float temp_d_mra = 0;
	float temp_d_bra = 0;
	
	float temp_dd_bla = 0;
	float temp_dd_mla = 0;
	float temp_dd_mra = 0;
	float temp_dd_bra = 0;
	
	dyn->set_d_bla(0);
	dyn->set_d_mla(0);
	dyn->set_d_mra(0);
	dyn->set_d_bra(0);
	
	while( t < tf ) {
		temp_d_bla = dyn->get_d_bla() + dyn->get_dd_bla() * dt;
		temp_d_mla = dyn->get_d_mla() + dyn->get_dd_mla() * dt;
		temp_d_mra = dyn->get_d_mra() + dyn->get_dd_mra() * dt;
		temp_d_bra = dyn->get_d_bra() + dyn->get_dd_bra() * dt;
		
		dyn->set_d_bla(temp_d_bla);
		dyn->set_d_mla(temp_d_mla);
		dyn->set_d_mra(temp_d_mra);
		dyn->set_d_bra(temp_d_bra);
		
		temp_bla = dyn->get_bla() + dyn->get_d_bla() * dt;
		temp_mla = dyn->get_mla() + dyn->get_d_mla() * dt;
		temp_mra = dyn->get_mra() + dyn->get_d_mra() * dt;
		temp_bra = dyn->get_bra() + dyn->get_d_bra() * dt;
		
		dyn->set_bla(temp_bla);
		dyn->set_mla(temp_mla);
		dyn->set_mra(temp_mra);
		dyn->set_bra(temp_bra);
		
		dyn->log(t);
		
		t += dt;
	}
}

int main() {
	Dynein* dyn = (Dynein*) malloc(sizeof(Dynein));
	resetLog();
	initProtein(dyn);
	simulateProtein(dyn, 0.1, 2.0);
	free(dyn);
	dyn = NULL;
	return 0;
}
