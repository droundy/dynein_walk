\documentclass[11pt,twocolumn]{article}

\usepackage[hmargin=1.25cm, vmargin=1.5cm]{geometry} % Document margins

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{fullpage}
\usepackage{verbatim}

\title{Brownian Dynein Model}

\newcommand{\mn}{\scalebox{0.7}[1.0]{-}}

\begin{document}

\maketitle

\section{Both bound}

\begin{figure}
  \includegraphics[width=\columnwidth]{../figures/code-bothbound}
  \caption{Angles used in both-bound case.}\label{fig:bothbound}
\end{figure}

In the both-bound case, we use two angles, as illustrated in
Fig.~\ref{fig:bothbound}.

These are the distances to the tail domain from the near and far
binding domains:
\begin{align}
  L_n &= \sqrt{L_s^2 + L_t^2 - 2L_sL_t\cos{\theta_{nm}}} \\
  L_f &= \sqrt{L_s^2 + L_t^2 - 2L_sL_t\cos{\theta_{fm}}}
\end{align}
We use two angles to determine the position of the motor domain:
\begin{align}
  \cos\theta_n &= \frac{L^2 + L_n^2 - L_f^2}{2L L_n} \\
  \sin\theta_{n} &= \sqrt{1 - \cos^2\theta_{n}} \\
  \cos\theta_{ns} &= \frac{L_s^2 + L_n^2 - L_t^2}{2L_s L_n} \\
  \sin\theta_{ns} &=
  \begin{cases}
    +\sqrt{1 - \cos^2\theta_{ns}} & \theta_{nm} < \pi \\
    -\sqrt{1 - \cos^2\theta_{ns}} & \theta_{nm} > \pi
  \end{cases}
\end{align}
Given these definitions, the position of the motor domain is given
simply by $\cos$ and $\sin$ of $\theta_n$ and $\theta_{ns}$:
\begin{align}
  X_{nm} &= L_s\left(
  \cos\theta_n\cos\theta_{ns} - \sin\theta_n\sin\theta_{ns}
  \right)
  \\
  Y_{nm} &= L_s\left(
  \cos\theta_n\sin\theta_{ns} + \sin\theta_n\cos\theta_{ns}
  \right)
\end{align}
Looking at their derivatives gives
\begin{multline}
  \dot{X}_{nm} = L_s\Big(
  \cos\theta_n\dot{\cos\theta_{ns}} + \cos\theta_{ns}\dot{\cos\theta_{n}} \\
  - \sin\theta_n\dot{\sin\theta_{ns}} - \sin\theta_{ns}\dot{\sin\theta_{n}}
  \Big)
\end{multline}
\begin{multline}
  \dot{Y}_{nm} = L_s\Big(
  \cos\theta_n\dot{\sin\theta_{ns}} + \sin\theta_{ns}\dot{\cos\theta_{n}} \\
  + \sin\theta_n\dot{\cos\theta_{ns}} + \cos\theta_{ns}\dot{\sin\theta_{n}}
  \Big)
\end{multline}
which we can apply the chain rule to using
\begin{align}
  \dot{Y}_{nm} = \frac{\partial Y_{nm}}{\partial L_n} \dot{L_n}
  +  \frac{\partial Y_{nm}}{\partial L_{f}} \dot{L_{f}}
\end{align}
and correspondingly for the $X$ formula.  So that now the interesting
things to compute in order to relate the time derivatives of $L_n$ and
$L_f$ to that of $Y_{nm}$ can easily be expressed in terms of these
partial derivatives with respect to the lengths $L_n$ and $L_f$.  This
gives us something like
\begin{multline}
  \frac{\partial X_{nm}}{\partial L_n} = L_s\Bigg(
  \cos\theta_n\frac{\partial \cos\theta_{ns}}{\partial L_n}
  + \cos\theta_{ns}\frac{\partial \cos\theta_{n}}{\partial L_n} \\
  - \sin\theta_n\frac{\partial \sin\theta_{ns}}{\partial L_n}
  - \sin\theta_{ns}\frac{\partial \sin\theta_{n}}{\partial L_n}
  \Bigg)
\end{multline}
However, the $\sin$s of our angles are expressed in terms of the
cosines, so we will (in practice) want to make use of the fact that
\begin{align}
  \frac{\partial \sin\theta_{n}}{\partial L_n} &=
  \frac{d \sin\theta_{n}}{d \cos\theta_n}
  \frac{\partial \cos\theta_{n}}{\partial L_n} \\
  &=
  -\frac{\cos\theta_{n}}{\sin\theta_n}
  \frac{\partial \cos\theta_{n}}{\partial L_n}
\end{align}
Using this we could imagine simplifying our former equation using this
expression for $\frac{\partial \sin\theta_{n}}{\partial L_n}$, but
that would only make it harder to read and check.  Let's keep all
chain rules and derivatives as explicit as possible!

The
corresponding C++ code could look like:
\begin{verbatim}
  dXnm_dLn = Ls*(cosAn*dcosAns_dLn
                 + cosAns*dcosAn_dLn
                 - sinAn*dsinAns_dLn
                 - sinAns*dsinAn_dLn);
\end{verbatim}
Basically, we have lots of chain rules.

\section{One bound}

\begin{figure}
  \includegraphics[width=\columnwidth]{../figures/code-onebound}
  \caption{Angles used in one-bound case.}\label{fig:onebound}
\end{figure}

In the one-bound case, we use four angles, as illustrated in
Fig.~\ref{fig:onebound}.

\end{document}
